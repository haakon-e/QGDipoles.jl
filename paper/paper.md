---
title: 'QGDipoles.jl: A Julia package for calculating dipolar vortex solutions to the Quasi-Geostrophic equations'
tags:
  - Julia
  - rotating fluid dynamics
  - vortex dynamics
  - oceanography
  - quasi-geostrophic flows
authors:
  - name: Matthew N. Crowe
    orcid: 0000-0002-9916-2653
    equal-contrib: true
    affiliation: "1, 2"
affiliations:
 - name: School of Mathematics, Statistics and Physics, Newcastle University, Newcastle upon Tyne, NE1 7RU, UK
   index: 1
 - name: Department of Mathematics, University College London, London, WC1E 6BT, UK
   index: 2
date: 07 November 2024
bibliography: paper.bib
---

# Summary

Give summary of field, rotating flows, ocean and atmospheric modelling

# Statement of need

The dynamics of the ocean and atmosphere consist of complicated, multiscale processes that can only be partially described by simplified analytical models.
As such, numerical simulations have become an important tool for both the modelling of idealised geophysical systems and the realistic simulation of the coupled ocean-atmosphere system.
Large scale processes---which generally occur on spatial scales of $>10$km in the ocean and $>100$km in the atmosphere---are dominated by the Earth's rotation and exist in a state close to 'geostrophic balance'; a balance between the Coriolis force and horizontal pressure gradients.
Such systems can be well described by the so-called 'quasi-geostrophic' equations, in which a vorticity-like quantity, known as 'potential vorticity' (PV) is advected around by the flow.
The system is closed since the flow-field is related to the PV through 'PV inversion', in which a Laplace-like equation is solved to determine a streamfunction.
QG systems are commonly used for idealised studies of large-scale ocean dynamics and are also some of the first equation sets studied by students in Geophyiscal Fluid dynamics courses across the world.

QG dynamics break down when studying small-scale flows and in the presence of features that change the leading order force balance, such as coastal boundaries or steep topographic slopes.
Therefore, realistic ocean-atmosphere modelling typically use 'primitive equation' models which solve variants of the Boussinesq Navier-Stokes equations.
While more realistic, a major difficulty with these models can be setting initial conditions, with many models requiring long spin-up times to reach a state when transients generated by the initial evolution have decayed.
Imposing initial conditions that obey QG dynamics can be a particularly effective strategy, as they exist in a 'balanced' state and do not generate fast inertial waves during the transient evolution phase.

Dipolar vortices are propagating structures which consist of two counter-rotating monopolar vortices moving together via self-advection.


`QGDipoles.jl` provides a series of functions that allow users to easily generate dipolar vortex solutions to two of the most commonly used QG models; the layered QG system (LQG) and the surface QG (SQG) system.
This package is intended both for those studying idealised vortex dynamics in a QG framework, and those looking to initialise a simulation with a steadily propagating, balanced vortex.
It is designed to be consistent with the framework of `GeophysicalFlows.jl', a Julia package that contains modules for solving various QG systems, and accepts `grid` inputs generated using the `TwoDGrid` function from `FourierFlows.jl`.
As such, `QGDipoles.jl` can generate solution arrays on both CPUs and GPUs using `CUDA.jl'.

# State of the field

While there has been much recent work on solvers for 

Not much, my Matlab script, basic function from GeophysicalFlows.jl for LCD
Good recent Julia codes for QG simulations and PE simulations (GF and Oceananigans)
This package consistent with GF

# Methodology

Summarise solutions, e.g. piecewise linear relationship between (potential) vorticity and streamfunction
Give brief outline of method, emphasise scalability; i.e. coefficients calculated semi-analytically and once coefficients are found, solution can be calculated on an arbitrarily large grid (so grid independent until final stage).
Reduce differential equation to a linear algebra problem
Note current linear algebra techniques not well developed for multi-parameter problems, so root finding used

# Acknowledgements

The author would like to thank ...

# References
